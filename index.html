<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=yes" />
  <title>Aplikasi Tabungan Modern + Investasi + Target</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />
  <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
  <link rel="stylesheet" href="style.css" />
</head>
<body>
<div class="container-fluid py-2 py-md-4">
  <!-- Header Card -->
  <div class="card">
    <div class="card-header d-flex flex-column flex-sm-row justify-content-between align-items-start align-items-sm-center">
      <h2 class="mb-2 mb-sm-0 fs-4 fs-md-3"><i class="fas fa-piggy-bank me-2"></i>Catatan Tabungan & Investasi</h2>
      <div class="d-flex align-items-center gap-2">
        <span class="badge bg-light text-dark fs-6"><i class="fas fa-wallet me-1"></i> <span id="totalTabungan">Rp 0</span></span>
        <span id="financialHealthBadge" class="badge">⚖️ Sehat</span>
      </div>
    </div>
    <div class="card-body">
      <!-- Form Input Transaksi dengan Pemisah Ribuan -->
      <div class="row g-2 g-md-3 mb-4">
        <div class="col-12 col-md-4">
          <div class="input-group">
            <span class="input-group-text"><i class="fas fa-align-left"></i></span>
            <input type="text" id="desc" class="form-control" placeholder="Deskripsi transaksi" />
          </div>
        </div>
        <div class="col-6 col-md-3">
          <div class="input-group">
            <span class="input-group-text">Rp</span>
            <input type="text" id="amount" class="form-control currency-input" placeholder="0" onkeyup="formatCurrency(this)" onblur="formatCurrency(this, true)" />
          </div>
        </div>
        <div class="col-6 col-md-3">
          <div class="input-group">
            <span class="input-group-text"><i class="fas fa-tags"></i></span>
            <select id="type" class="form-select">
              <option value="pemasukan">Pemasukan</option>
              <option value="pengeluaran">Pengeluaran</option>
            </select>
          </div>
        </div>
        <div class="col-12 col-md-2">
          <button class="btn btn-success w-100" onclick="addTransaction()">
            <i class="fas fa-plus-circle me-1"></i> Tambah
          </button>
        </div>
      </div>

      <!-- Filter Buttons -->
      <div class="d-flex flex-column flex-sm-row justify-content-between align-items-start align-items-sm-center mb-3 gap-2">
        <div class="d-flex flex-wrap align-items-center gap-2">
          <button class="btn btn-primary btn-sm" onclick="exportToExcel()">
            <i class="fas fa-file-excel me-1"></i> Export Excel
          </button>
          <div class="btn-group btn-group-sm" role="group">
            <button class="btn btn-outline-primary filter-btn active" id="filterAll" data-filter="all" onclick="setFilter('all')">
              Semua
            </button>
            <button class="btn btn-outline-success filter-btn" id="filterIncome" data-filter="pemasukan" onclick="setFilter('pemasukan')">
              <i class="fas fa-arrow-down"></i>
            </button>
            <button class="btn btn-outline-danger filter-btn" id="filterExpense" data-filter="pengeluaran" onclick="setFilter('pengeluaran')">
              <i class="fas fa-arrow-up"></i>
            </button>
          </div>
          <select id="rowPerPage" onchange="renderTable()" class="form-select form-select-sm d-inline-block w-auto">
            <option value="10">10</option>
            <option value="20">20</option>
            <option value="50">50</option>
          </select>
        </div>
        <div class="w-100 w-sm-auto">
          <input type="text" id="searchInput" class="form-control form-control-sm" placeholder="Cari transaksi..." oninput="renderTable()" />
        </div>
      </div>

      <!-- Tabel Transaksi -->
      <div class="table-responsive">
        <table class="table table-hover table-sm">
          <thead class="table-dark">
            <tr>
              <th>Tanggal</th>
              <th>Deskripsi</th>
              <th>Jenis</th>
              <th>Nominal</th>
              <th>Aksi</th>
            </tr>
          </thead>
          <tbody id="transactionTable"></tbody>
        </table>
      </div>

      <!-- Pagination -->
      <nav class="mt-3">
        <ul class="pagination pagination-sm justify-content-center" id="pagination"></ul>
      </nav>
    </div>
  </div>

  <!-- Summary Cards Utama -->
  <div class="row mt-3 mt-md-4 g-2 g-md-3">
    <div class="col-4">
      <div class="card summary-card summary-income h-100">
        <div class="card-body p-2 p-md-3">
          <h6 class="card-title small"><i class="fas fa-arrow-down text-success me-1"></i> Masuk</h6>
          <p class="card-text fs-6 fs-md-4 fw-bold mb-0" id="totalIncome">Rp 0</p>
        </div>
      </div>
    </div>
    <div class="col-4">
      <div class="card summary-card summary-expense h-100">
        <div class="card-body p-2 p-md-3">
          <h6 class="card-title small"><i class="fas fa-arrow-up text-danger me-1"></i> Keluar</h6>
          <p class="card-text fs-6 fs-md-4 fw-bold mb-0" id="totalExpense">Rp 0</p>
        </div>
      </div>
    </div>
    <div class="col-4">
      <div class="card summary-card summary-total h-100">
        <div class="card-body p-2 p-md-3">
          <h6 class="card-title small"><i class="fas fa-balance-scale text-primary me-1"></i> Kas</h6>
          <p class="card-text fs-6 fs-md-4 fw-bold mb-0" id="totalBalance">Rp 0</p>
        </div>
      </div>
    </div>
  </div>

  <!-- M-Banking Section -->
  <div class="card mt-3">
    <div class="card-header d-flex flex-column flex-sm-row justify-content-between align-items-start align-items-sm-center">
      <h5 class="mb-2 mb-sm-0 fs-6 fs-md-5"><i class="fas fa-mobile-alt me-2"></i>M-Banking</h5>
      <div class="d-flex flex-wrap gap-2 w-100 w-sm-auto">
        <select id="bankSelect" class="form-select form-select-sm w-auto">
          <option value="BCA">BCA</option>
          <option value="Mandiri">Mandiri</option>
          <option value="BRI">BRI</option>
          <option value="BNI">BNI</option>
          <option value="CIMB Niaga">CIMB Niaga</option>
          <option value="Danamon">Danamon</option>
          <option value="Permata">Permata</option>
          <option value="Maybank">Maybank</option>
          <option value="Bank Lain">Bank Lain</option>
        </select>
        <div class="input-group input-group-sm w-auto">
          <span class="input-group-text">Rp</span>
          <input type="text" id="mbankingSaldo" class="form-control currency-input" placeholder="0" onkeyup="formatCurrency(this)" onblur="formatCurrency(this, true)" style="min-width: 120px;">
        </div>
        <button class="btn btn-sm btn-warning" onclick="addMBanking()">
          <i class="fas fa-plus-circle"></i> Tambah
        </button>
      </div>
    </div>
    <div class="card-body">
      <!-- Filter M-Banking -->
      <div class="d-flex justify-content-between align-items-center mb-3">
        <div class="d-flex align-items-center gap-2">
          <span class="small fw-bold">Filter Bank:</span>
          <select id="filterBank" class="form-select form-select-sm w-auto" onchange="filterMBanking()">
            <option value="all">Semua Bank</option>
            <option value="BCA">BCA</option>
            <option value="Mandiri">Mandiri</option>
            <option value="BRI">BRI</option>
            <option value="BNI">BNI</option>
            <option value="CIMB Niaga">CIMB Niaga</option>
            <option value="Danamon">Danamon</option>
            <option value="Permata">Permata</option>
            <option value="Maybank">Maybank</option>
            <option value="Bank Lain">Bank Lain</option>
          </select>
        </div>
        <span class="small text-muted" id="totalMBankingDisplay">Total: Rp 0</span>
      </div>
      <div id="mbankingList" class="row g-2 g-md-3"></div>
    </div>
  </div>

  <!-- Investasi Section -->
  <div class="card mt-3">
    <div class="card-header d-flex flex-column flex-sm-row justify-content-between align-items-start align-items-sm-center">
      <h5 class="mb-2 mb-sm-0 fs-6 fs-md-5"><i class="fas fa-chart-line me-2"></i>Investasi</h5>
      <div class="d-flex flex-wrap gap-2">
        <button class="btn btn-sm btn-info" onclick="addInvestmentType()">
          <i class="fas fa-plus-circle"></i> Jenis
        </button>
        <button class="btn btn-sm btn-success" onclick="addInvestment()">
          <i class="fas fa-plus-circle"></i> Tambah
        </button>
      </div>
    </div>
    <div class="card-body">
      <!-- Form Input Investasi dengan Pemisah Ribuan -->
      <div class="row g-2 mb-3">
        <div class="col-6 col-md-3">
          <select id="investmentType" class="form-select form-select-sm"></select>
        </div>
        <div class="col-6 col-md-3">
          <input type="text" id="investmentName" class="form-control form-control-sm" placeholder="Nama">
        </div>
        <div class="col-4 col-md-2">
          <div class="input-group input-group-sm">
            <span class="input-group-text">Rp</span>
            <input type="text" id="investmentValue" class="form-control currency-input" placeholder="0" onkeyup="formatCurrency(this)" onblur="formatCurrency(this, true)">
          </div>
        </div>
        <div class="col-4 col-md-2">
          <input type="number" id="investmentQuantity" class="form-control form-control-sm" placeholder="Jml" value="1">
        </div>
        <div class="col-4 col-md-2">
          <select id="filterInvestmentType" class="form-select form-select-sm" onchange="filterInvestments()">
            <option value="all">Semua</option>
          </select>
        </div>
      </div>
      
      <!-- Filter Investasi -->
      <div class="d-flex justify-content-between align-items-center mb-3">
        <div class="d-flex align-items-center gap-2">
          <span class="small fw-bold">Urutkan:</span>
          <select id="sortInvestment" class="form-select form-select-sm w-auto" onchange="filterInvestments()">
            <option value="name">Nama A-Z</option>
            <option value="value">Nilai Tertinggi</option>
            <option value="type">Jenis</option>
          </select>
        </div>
        <span class="small text-muted" id="totalInvestmentsDisplay">Total: Rp 0</span>
      </div>
      
      <!-- Daftar Investasi -->
      <div id="investmentList" class="row g-2 g-md-3"></div>
    </div>
  </div>

  <!-- Summary Cards Investasi Dinamis -->
  <div class="row g-2 g-md-3 mt-2" id="investmentSummaryCards"></div>

  <!-- UTANG SECTION -->
  <div class="card mt-3">
    <div class="card-header d-flex flex-column flex-sm-row justify-content-between align-items-start align-items-sm-center" style="background-color: #dc3545;">
      <h5 class="mb-2 mb-sm-0 fs-6 fs-md-5"><i class="fas fa-credit-card me-2"></i>Catatan Utang</h5>
      <div class="d-flex flex-wrap gap-2">
        <input type="text" id="utangName" class="form-control form-control-sm w-auto" placeholder="Nama utang">
        <div class="input-group input-group-sm w-auto">
          <span class="input-group-text">Rp</span>
          <input type="text" id="utangAmount" class="form-control currency-input" placeholder="0" onkeyup="formatCurrency(this)" onblur="formatCurrency(this, true)" style="min-width: 120px;">
        </div>
        <input type="date" id="utangDueDate" class="form-control form-control-sm w-auto">
        <button class="btn btn-sm btn-light" onclick="addUtang()">
          <i class="fas fa-plus-circle"></i> Tambah
        </button>
      </div>
    </div>
    <div class="card-body">
      <!-- Filter Utang -->
      <div class="d-flex justify-content-between align-items-center mb-3">
        <div class="d-flex align-items-center gap-2">
          <span class="small fw-bold">Filter:</span>
          <select id="filterUtang" class="form-select form-select-sm w-auto" onchange="filterUtang()">
            <option value="all">Semua Utang</option>
            <option value="active">Masih Aktif</option>
            <option value="lunas">Sudah Lunas</option>
          </select>
        </div>
        <span class="small text-danger fw-bold" id="totalUtangDisplay">Total Utang Aktif: Rp 0</span>
      </div>
      
      <!-- Daftar Utang -->
      <div id="utangList" class="row g-2 g-md-3"></div>
    </div>
  </div>

  <!-- Summary Card Utang -->
  <div class="row g-2 g-md-3 mt-2">
    <div class="col-6">
      <div class="card summary-card" style="border-left-color: #dc3545;">
        <div class="card-body p-2 p-md-3">
          <h6 class="card-title small"><i class="fas fa-credit-card text-danger me-1"></i> Total Utang Aktif</h6>
          <p class="card-text fs-6 fs-md-5 fw-bold mb-0 text-danger" id="totalUtangAktif">Rp 0</p>
        </div>
      </div>
    </div>
    <div class="col-6">
      <div class="card summary-card" style="border-left-color: #28a745;">
        <div class="card-body p-2 p-md-3">
          <h6 class="card-title small"><i class="fas fa-check-circle text-success me-1"></i> Total Utang Lunas</h6>
          <p class="card-text fs-6 fs-md-5 fw-bold mb-0 text-success" id="totalUtangLunas">Rp 0</p>
        </div>
      </div>
    </div>
  </div>

  <!-- TARGET SECTION -->
  <div class="card mt-3">
    <div class="card-header d-flex flex-column flex-sm-row justify-content-between align-items-start align-items-sm-center" style="background: linear-gradient(135deg, #00b09b, #96c93d);">
      <h5 class="mb-2 mb-sm-0 fs-6 fs-md-5"><i class="fas fa-bullseye me-2"></i>Target Belanja & Impian</h5>
      <div class="d-flex flex-wrap gap-2">
        <input type="text" id="targetName" class="form-control form-control-sm w-auto" placeholder="Nama target">
        <div class="input-group input-group-sm w-auto">
          <span class="input-group-text">Rp</span>
          <input type="text" id="targetAmount" class="form-control currency-input" placeholder="0" onkeyup="formatCurrency(this)" onblur="formatCurrency(this, true)" style="min-width: 120px;">
        </div>
        <select id="targetPriority" class="form-select form-select-sm w-auto">
          <option value="high">Prioritas Tinggi</option>
          <option value="medium">Prioritas Sedang</option>
          <option value="low">Prioritas Rendah</option>
        </select>
        <button class="btn btn-sm btn-light" onclick="addTarget()">
          <i class="fas fa-plus-circle"></i> Tambah Target
        </button>
      </div>
    </div>
    <div class="card-body">
      <!-- Filter Target -->
      <div class="d-flex justify-content-between align-items-center mb-3">
        <div class="d-flex align-items-center gap-2">
          <span class="small fw-bold">Filter:</span>
          <select id="filterTarget" class="form-select form-select-sm w-auto" onchange="filterTargets()">
            <option value="all">Semua Target</option>
            <option value="achieved">Sudah Tercapai</option>
            <option value="notachieved">Belum Tercapai</option>
          </select>
          <select id="sortTarget" class="form-select form-select-sm w-auto" onchange="filterTargets()">
            <option value="progress">Progress Terbesar</option>
            <option value="name">Nama A-Z</option>
            <option value="amount">Target Tertinggi</option>
          </select>
        </div>
        <span class="small text-success fw-bold" id="totalTargetDisplay">Total Target: Rp 0</span>
      </div>
      
      <!-- Daftar Target -->
      <div id="targetList" class="row g-2 g-md-3"></div>
    </div>
  </div>

  <!-- Total Keseluruhan dengan Kondisi Keuangan -->
  <div class="card mt-3" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white;">
    <div class="card-body d-flex flex-column flex-sm-row justify-content-between align-items-start align-items-sm-center p-2 p-md-3">
      <div class="d-flex align-items-center gap-2">
        <h6 class="mb-0 fs-6"><i class="fas fa-chart-pie me-2"></i>Total Kekayaan Bersih</h6>
        <span id="financialDetailBadge" class="badge bg-light text-dark">Sehat</span>
      </div>
      <div class="text-end">
        <h5 class="mb-0 fs-5" id="totalGrand">Rp 0</h5>
        <small class="text-white-50">(Aset - Utang)</small>
      </div>
    </div>
  </div>
</div>

<script src="script.js"></script>
</body>
</html>
